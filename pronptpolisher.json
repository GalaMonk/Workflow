{"last_node_id":40,"last_link_id":48,"nodes":[{"id":25,"type":"KSampler","pos":[1210,1290],"size":{"0":315,"1":474},"flags":{},"order":24,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":23},{"name":"positive","type":"CONDITIONING","link":22},{"name":"negative","type":"CONDITIONING","link":21},{"name":"latent_image","type":"LATENT","link":20,"slot_index":3}],"outputs":[{"name":"LATENT","type":"LATENT","links":[25],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[254254487164606,"randomize",28,7,"dpmpp_2m","karras",1]},{"id":3,"type":"CLIPTextEncode","pos":[720,860],"size":{"0":400,"1":54},"flags":{},"order":14,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":2},{"name":"text","type":"STRING","link":38,"widget":{"name":"text"}}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[3],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["1girl, souryuu asuka langley, neon genesis evangelion, rebuild of evangelion, lance of longinus, cat hat, plugsuit, pilot suit, red bodysuit, sitting, crossed legs, black eye patch, throne, looking down, from bottom, looking at viewer, outdoors, (masterpiece), (best quality), (ultra-detailed), very aesthetic, illustration, disheveled hair, perfect composition, moist skin, intricate details\n"]},{"id":2,"type":"KSampler","pos":[1220,710],"size":{"0":315,"1":474},"flags":{},"order":16,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":1},{"name":"positive","type":"CONDITIONING","link":3},{"name":"negative","type":"CONDITIONING","link":5},{"name":"latent_image","type":"LATENT","link":9,"slot_index":3}],"outputs":[{"name":"LATENT","type":"LATENT","links":[6],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[955031423524937,"randomize",28,7,"dpmpp_2m","karras",1]},{"id":24,"type":"VAEDecode","pos":[1600,1340],"size":{"0":210,"1":46},"flags":{},"order":25,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":25},{"name":"vae","type":"VAE","link":26}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[27],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":1,"type":"CheckpointLoaderSimple","pos":[190,1070],"size":{"0":315,"1":98},"flags":{},"order":0,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[1,23],"shape":3,"slot_index":0},{"name":"CLIP","type":"CLIP","links":[2,4,34],"shape":3,"slot_index":1},{"name":"VAE","type":"VAE","links":[7,26],"shape":3,"slot_index":2}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["animagine-xl-3.1.safetensors"]},{"id":29,"type":"Note","pos":[100,380],"size":{"0":240,"1":80},"flags":{},"order":1,"mode":0,"properties":{"text":""},"widgets_values":["Not limited to English, you can try any language."],"color":"#c09430"},{"id":5,"type":"VAEDecode","pos":[1590,760],"size":{"0":210,"1":46},"flags":{},"order":18,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":6},{"name":"vae","type":"VAE","link":7}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[8],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":17,"type":"DisplayText_Zho","pos":[1240,100],"size":{"0":260,"1":150},"flags":{},"order":13,"mode":0,"inputs":[{"name":"text","type":"STRING","link":37,"widget":{"name":"text"}}],"outputs":[{"name":"text","type":"STRING","links":null,"shape":3}],"title":"Original prompt","properties":{"Node name for S&R":"DisplayText_Zho"},"widgets_values":["","A ninja in Cyberpunk 2077."]},{"id":4,"type":"CLIPTextEncode","pos":[720,990],"size":{"0":400,"1":200},"flags":{},"order":8,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":4}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[5,21],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["nsfw, lowres, (bad), text, error, fewer, extra, missing, worst quality, jpeg artifacts, low quality, watermark, unfinished, displeasing, oldest, early, chromatic aberration, signature, extra digits, artistic error, username, scan, [abstract]"],"color":"#af3535"},{"id":26,"type":"CLIPTextEncode","pos":[720,1270],"size":{"0":400,"1":54},"flags":{},"order":23,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":34},{"name":"text","type":"STRING","link":47,"widget":{"name":"text"}}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[22],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["1girl, souryuu asuka langley, neon genesis evangelion, rebuild of evangelion, lance of longinus, cat hat, plugsuit, pilot suit, red bodysuit, sitting, crossed legs, black eye patch, throne, looking down, from bottom, looking at viewer, outdoors, (masterpiece), (best quality), (ultra-detailed), very aesthetic, illustration, disheveled hair, perfect composition, moist skin, intricate details\n"]},{"id":7,"type":"EmptyLatentImage","pos":[800,1390],"size":{"0":315,"1":106},"flags":{},"order":2,"mode":0,"outputs":[{"name":"LATENT","type":"LATENT","links":[9,20],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"EmptyLatentImage"},"widgets_values":[1216,832,1]},{"id":13,"type":"CR Text Concatenate","pos":[710,100],"size":{"0":210,"1":80},"flags":{},"order":9,"mode":0,"inputs":[{"name":"text1","type":"STRING","link":10,"widget":{"name":"text1"},"slot_index":0},{"name":"text2","type":"STRING","link":11,"widget":{"name":"text2"}}],"outputs":[{"name":"STRING","type":"*","links":[36],"shape":3,"slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3}],"properties":{"Node name for S&R":"CR Text Concatenate"},"widgets_values":["","",""]},{"id":18,"type":"CR Text Concatenate","pos":[710,320],"size":{"0":210,"1":80},"flags":{},"order":10,"mode":0,"inputs":[{"name":"text1","type":"STRING","link":18,"widget":{"name":"text1"},"slot_index":0},{"name":"text2","type":"STRING","link":17,"widget":{"name":"text2"},"slot_index":1}],"outputs":[{"name":"STRING","type":"*","links":[39],"shape":3,"slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3}],"properties":{"Node name for S&R":"CR Text Concatenate"},"widgets_values":["","",""]},{"id":6,"type":"SaveImage","pos":[1870,600],"size":{"0":829.6702880859375,"1":694.4478759765625},"flags":{},"order":21,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":8}],"title":"Original prompt","properties":{"Node name for S&R":"SaveImage"},"widgets_values":["ComfyUI"]},{"id":23,"type":"SaveImage","pos":[1870,1340],"size":{"0":829.6702880859375,"1":694.4478759765625},"flags":{},"order":26,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":27}],"title":"Polished prompt","properties":{"Node name for S&R":"SaveImage"},"widgets_values":["ComfyUI"]},{"id":20,"type":"DisplayText_Zho","pos":[1240,320],"size":{"0":260,"1":170},"flags":{},"order":15,"mode":0,"inputs":[{"name":"text","type":"STRING","link":40,"widget":{"name":"text"}}],"outputs":[{"name":"text","type":"STRING","links":[44],"shape":3,"slot_index":0}],"title":"Polished prompt","properties":{"Node name for S&R":"DisplayText_Zho"},"widgets_values":["","Wow, you've done an excellent job refining the prompt!\n\nI'll summarize your refined prompt:\n\n**# 1 boy and 1 girl, [Asian boy with dark hair and brown eyes, wearing deep purple suit with lapel], [girl in elegant beige gown with long sleeves, leaning against him], making peace signs, smiling, friendly interaction, bright colors, sunny background, anime-style scene from Studio Ghibli #**\n\nThis refined prompt provides a clear visual description of the characters, their clothing, and the setting. It also highlights the peaceful and friendly tone of the scene. The inclusion of specific details like dark hair, brown eyes, deep purple suit, and beige gown helps to create a more vivid image.\n\nI'll note that you've maintained the original prompt's focus on Studio Ghibli anime-style scenes, which is great for anyone looking to create artwork or cosplay inspired by this style.\n\nYour refined prompt is now ready to be used as a reference for creating art, writing stories, or even directing an animation scene!"]},{"id":37,"type":"OllamaGenerate","pos":[1780,320],"size":{"0":260,"1":118.00001525878906},"flags":{},"order":19,"mode":0,"inputs":[{"name":"prompt","type":"STRING","link":43,"widget":{"name":"prompt"}}],"outputs":[{"name":"response","type":"STRING","links":[42,47],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"OllamaGenerate"},"widgets_values":["What is Art?","enable","http://127.0.0.1:11434","llama3:8b-instruct-fp16"]},{"id":36,"type":"DisplayText_Zho","pos":[2070,320],"size":{"0":260,"1":220},"flags":{},"order":22,"mode":0,"inputs":[{"name":"text","type":"STRING","link":42,"widget":{"name":"text"}}],"outputs":[{"name":"text","type":"STRING","links":null,"shape":3}],"title":"Polished prompt","properties":{"Node name for S&R":"DisplayText_Zho"},"widgets_values":["","1 boy and 1 girl, [Asian boy with dark hair and brown eyes, wearing deep purple suit with lapel], [girl in elegant beige gown with long sleeves, leaning against him], making peace signs, smiling, friendly interaction, bright colors, sunny background, anime-style scene from Studio Ghibli"]},{"id":35,"type":"CR Text Concatenate","pos":[1540,320],"size":{"0":210,"1":80},"flags":{},"order":17,"mode":0,"inputs":[{"name":"text1","type":"STRING","link":44,"widget":{"name":"text1"},"slot_index":0},{"name":"text2","type":"STRING","link":46,"widget":{"name":"text2"},"slot_index":1}],"outputs":[{"name":"STRING","type":"*","links":[43,48],"shape":3,"slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3}],"properties":{"Node name for S&R":"CR Text Concatenate"},"widgets_values":["","",""]},{"id":39,"type":"DisplayText_Zho","pos":[2070,-260],"size":{"0":730,"1":530},"flags":{},"order":20,"mode":0,"inputs":[{"name":"text","type":"STRING","link":48,"widget":{"name":"text"}}],"outputs":[{"name":"text","type":"STRING","links":null,"shape":3}],"title":"Polished prompt","properties":{"Node name for S&R":"DisplayText_Zho"},"widgets_values":["","Wow, you've done an excellent job refining the prompt!\n\nI'll summarize your refined prompt:\n\n**# 1 boy and 1 girl, [Asian boy with dark hair and brown eyes, wearing deep purple suit with lapel], [girl in elegant beige gown with long sleeves, leaning against him], making peace signs, smiling, friendly interaction, bright colors, sunny background, anime-style scene from Studio Ghibli #**\n\nThis refined prompt provides a clear visual description of the characters, their clothing, and the setting. It also highlights the peaceful and friendly tone of the scene. The inclusion of specific details like dark hair, brown eyes, deep purple suit, and beige gown helps to create a more vivid image.\n\nI'll note that you've maintained the original prompt's focus on Studio Ghibli anime-style scenes, which is great for anyone looking to create artwork or cosplay inspired by this style.\n\nYour refined prompt is now ready to be used as a reference for creating art, writing stories, or even directing an animation scene!\n\n----\n\nExtract content within # #, excluding  # #. \nJust output the content within # #, nothing less, nothing more."]},{"id":14,"type":"CR Text","pos":[420,100],"size":{"0":240,"1":130},"flags":{},"order":3,"mode":0,"outputs":[{"name":"text","type":"*","links":[10],"shape":3,"slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3}],"properties":{"Node name for S&R":"CR Text"},"widgets_values":["Translate the following into English, do not add any text other than the prompt:"]},{"id":31,"type":"OllamaGenerate","pos":[950,100],"size":{"0":260,"1":118.00001525878906},"flags":{},"order":11,"mode":0,"inputs":[{"name":"prompt","type":"STRING","link":36,"widget":{"name":"prompt"}}],"outputs":[{"name":"response","type":"STRING","links":[37,38],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"OllamaGenerate"},"widgets_values":["What is Art?","enable","http://127.0.0.1:11434","llama3:8b-instruct-fp16"]},{"id":32,"type":"OllamaGenerate","pos":[950,320],"size":{"0":260,"1":118.00001525878906},"flags":{},"order":12,"mode":0,"inputs":[{"name":"prompt","type":"STRING","link":39,"widget":{"name":"prompt"}}],"outputs":[{"name":"response","type":"STRING","links":[40],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"OllamaGenerate"},"widgets_values":["What is Art?","enable","http://127.0.0.1:11434","llama3:8b-instruct-fp16"]},{"id":15,"type":"CR Text","pos":[100,200],"size":{"0":240,"1":130},"flags":{},"order":4,"mode":0,"outputs":[{"name":"text","type":"*","links":[11,17],"shape":3,"slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3}],"properties":{"Node name for S&R":"CR Text"},"widgets_values":["一个忍者在赛博朋克2077中"],"color":"#346434"},{"id":40,"type":"Note","pos":[320,770],"size":{"0":340,"1":60},"flags":{},"order":5,"mode":0,"properties":{"text":""},"widgets_values":["A walkthrough video of this workflow (Chinese)\nhttps://www.youtube.com/watch?v=daKKfUReOSo"],"color":"#006691"},{"id":38,"type":"CR Text","pos":[1250,530],"size":{"0":250,"1":120},"flags":{},"order":6,"mode":0,"outputs":[{"name":"text","type":"*","links":[46],"shape":3,"slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3}],"properties":{"Node name for S&R":"CR Text"},"widgets_values":["\n\n----\n\nExtract content within # #, excluding  # #. \nJust output the content within # #, nothing less, nothing more."]},{"id":21,"type":"CR Text","pos":[420,320],"size":{"0":240,"1":400},"flags":{},"order":7,"mode":0,"outputs":[{"name":"text","type":"*","links":[18],"shape":3,"slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3}],"properties":{"Node name for S&R":"CR Text"},"widgets_values":["You are a prompt engineer proficient in SDXL painting, especially skilled in refining prompts. Please strictly follow the steps below to refine the prompts that need to be refined, operate step by step and output the results of each step:\n\nStep 1: List the names and genders of all the characters in the prompt. If there are no characters in the prompt, skip this step.\n\nStep 2: Use a short phrase to describe all the characters in the prompt. This phrase can use plurals or and, do not use any punctuation. Do not use any punctuation in this short phrase. Do not use any punctuation in this short phrase. The format is as follows:\n- 1boy\n- 1girl\n- 2boys\n- 2girls\n- 1girl and 1boy\n\nStep 3: Identify the main subjects in the prompt word. If you can guess which work it/them comes from, list the name of the work in the format:\n- Link from The Legend of Zelda series, Spider-Man from Marvel movies, ...\nIf there is no prominent subject in the prompt, such as if the prompt is purely a landscape, skip this step.\n\nStep 4: Combine the contents of the previous two steps, separated by commas. If there is no prominent subject in the prompt, such as if the prompt is pure scenery, skip this step and do not output any characters.\n\nStep 5: \nIf the prompt contains a character, use the result from the previous step as the beginning, and creatively refine the rest of the prompt as a whole in English, 80 words,following the format: Number of characters and gender of characters, [character 1], [character 2], [character ...], everything else in any order. Examples of refined prompt:\n- 1man, [young man with ((short gray hair)), black turtleneck sweater, suspenders, singing, smiling, holding a basketball,  a pendant necklace], plain white wall background, focus on him and his actions, anime-style scene\n- 2 girls, [one on the left wearing a gray T-shirt holding a laptop in her hand], [one on the right wearing a Wonder Woman costume], anime-style scene\n- 1 boy and 1 girl, [Chun-Li from Street Fighter] and [Spider-Man from Marvel movies], engaged in a fierce battle, dynamic fighting poses, action movie poster\n- 1 boy and 1 girl, [K-pop male singer (left of center) with short black hair, brown eyes, white color, formal suit with satin lapel and bow tie], [K-pop female singer (center) with long straight black hair, dark brown eyes, white color, formal silver dress], both singers holding hands up in peace signs, anime-style scene, bright colors, sunny background\n\nIf the prompt does not contain a character but does contain a clear subject, use the result of the previous step as the beginning and use your imagination to refine the prompt as a whole. The language should be English and the format should be \"subject name, everything else in any order.\"\n\nIf the prompt does not contain a character or a clear subject, use your imagination to refine the prompt as a whole, in English.\n\nStep 6: Enclose the result of the previous step within # #\n\nPrompt that need refining:\n"]}],"links":[[1,1,0,2,0,"MODEL"],[2,1,1,3,0,"CLIP"],[3,3,0,2,1,"CONDITIONING"],[4,1,1,4,0,"CLIP"],[5,4,0,2,2,"CONDITIONING"],[6,2,0,5,0,"LATENT"],[7,1,2,5,1,"VAE"],[8,5,0,6,0,"IMAGE"],[9,7,0,2,3,"LATENT"],[10,14,0,13,0,"STRING"],[11,15,0,13,1,"STRING"],[17,15,0,18,1,"STRING"],[18,21,0,18,0,"STRING"],[20,7,0,25,3,"LATENT"],[21,4,0,25,2,"CONDITIONING"],[22,26,0,25,1,"CONDITIONING"],[23,1,0,25,0,"MODEL"],[25,25,0,24,0,"LATENT"],[26,1,2,24,1,"VAE"],[27,24,0,23,0,"IMAGE"],[34,1,1,26,0,"CLIP"],[36,13,0,31,0,"STRING"],[37,31,0,17,0,"STRING"],[38,31,0,3,1,"STRING"],[39,18,0,32,0,"STRING"],[40,32,0,20,0,"STRING"],[42,37,0,36,0,"STRING"],[43,35,0,37,0,"STRING"],[44,20,0,35,0,"STRING"],[46,38,0,35,1,"STRING"],[47,37,0,26,1,"STRING"],[48,35,0,39,0,"STRING"]],"groups":[],"config":{},"extra":{},"version":0.4,"widget_idx_map":{"2":{"seed":0,"sampler_name":4,"scheduler":5},"25":{"seed":0,"sampler_name":4,"scheduler":5}},"seed_widgets":{"2":0,"25":0}}